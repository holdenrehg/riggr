/* Part of the Riggr SPA framework <https://github.com/Fluidbyte/Riggr> and released under the MIT license. This notice must remain intact. */
!function(a,b){"function"==typeof define&&define.amd?define(["date"],b):"object"==typeof exports?module.exports=b(require("date")):a.metric=b(a.date)}(this,function(){return function(){var a=function(a,b,c){this.event=a,this.el=b,this.data=c},b={watching:{},metricId:0,namespace:"metric",config:void 0,watch:function(c,d,e){return e=e||{},$(d).on([c,b.metricId,b.namespace].join("."),{metricId:b.metricId},b.onEvent),b.watching[b.metricId]=new a(c,d,e),b.metricId++},unwatch:function(a){if(b.watching[a]){var c=b.watching[a],d=[c.event,a,b.namespace].join(".");$(c.el).off(d)}},publish:function(a){console.log(a)},onEvent:function(a){if(a.stopPropagation(),b.watching[a.data.metricId]){var c=b.watching[a.data.metricId];$.extend(c.data,{domE:a}),b.publish(c)}},view:{current:void 0,load:function(a){b.view.current={controller:a,start:new Date}},unload:function(){var c=b.view.current,d=new Date,e=(d-c.start)/1e3;b.publish(new a("unload",void 0,{path:c.controller.path(),pageTitle:c.controller.pageTitle,secondsWatched:e,start:c.start,stop:d}))}}};return b}()});